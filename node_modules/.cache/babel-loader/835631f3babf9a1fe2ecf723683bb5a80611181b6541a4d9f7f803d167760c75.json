{"ast":null,"code":"import classNames from 'classnames';\nimport React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useCtx } from '..';\nimport { DropdownContext } from './DropdownContext';\nimport { MenuContext } from './MenuContext';\nimport { OptionAction } from './OptionAction';\nimport s from './styles.module.css.json';\nexport var Option = function (_a) {\n  var _b;\n  var onClick = _a.onClick,\n    to = _a.to,\n    active = _a.active,\n    red = _a.red,\n    valid = _a.valid,\n    invalid = _a.invalid,\n    children = _a.children,\n    disabled = _a.disabled,\n    closeMenuOnClick = _a.closeMenuOnClick;\n  var ctx = useCtx();\n  var id = useMemo(function () {\n    return new Date().getTime().toString(36);\n  }, []);\n  var _c = useContext(MenuContext),\n    searchTerm = _c.searchTerm,\n    addOption = _c.addOption,\n    setClickHandlerForOption = _c.setClickHandlerForOption;\n  var childrenArray = React.Children.toArray(children);\n  var buttons = childrenArray.filter(function (child) {\n    return typeof child === 'object' && 'type' in child && child.type === OptionAction;\n  });\n  var notButtons = childrenArray.filter(function (child) {\n    return typeof child !== 'object' || !('type' in child) || child.type !== OptionAction;\n  });\n  var contentRef = useRef(null);\n  var _d = useState(''),\n    innerText = _d[0],\n    setInnerText = _d[1];\n  useEffect(function () {\n    if (contentRef.current) {\n      setInnerText(contentRef.current.innerText);\n    }\n  });\n  var closeMenu = useContext(DropdownContext).closeMenu;\n  var handleClick = useCallback(function (e) {\n    if (!onClick && !to) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    if (disabled) {\n      return;\n    }\n    if (closeMenuOnClick !== null && closeMenuOnClick !== void 0 ? closeMenuOnClick : true) {\n      closeMenu();\n    }\n    if (to) {\n      ctx === null || ctx === void 0 ? void 0 : ctx.navigateTo(to);\n    }\n    if (onClick) {\n      onClick(e);\n    }\n  }, [closeMenuOnClick, closeMenu, onClick, to]);\n  useEffect(function () {\n    return addOption(id);\n  }, [id]);\n  useEffect(function () {\n    return setClickHandlerForOption(id, handleClick);\n  }, [id, handleClick, setClickHandlerForOption]);\n  if (innerText && searchTerm && !innerText.toLowerCase().includes(searchTerm.toLowerCase())) {\n    return null;\n  }\n  var content = React.createElement(React.Fragment, null, React.createElement(\"button\", {\n    type: \"button\",\n    className: s.Dropdown__menu__option__content,\n    ref: contentRef,\n    onClick: handleClick\n  }, notButtons), buttons.length > 0 && React.createElement(\"div\", {\n    className: s.Dropdown__menu__option__icons\n  }, buttons));\n  return React.createElement(\"div\", {\n    className: classNames(s.Dropdown__menu__option, (_b = {}, _b[s['Dropdown__menu__option--is-active']] = active, _b[s['Dropdown__menu__option--is-disabled']] = disabled, _b[s['Dropdown__menu__option--is-valid']] = valid, _b[s['Dropdown__menu__option--is-invalid']] = invalid, _b[s['Dropdown__menu__option--is-dangerous']] = red, _b)),\n    \"data-option-id\": id\n  }, content);\n};","map":{"version":3,"names":["classNames","React","useCallback","useContext","useEffect","useMemo","useRef","useState","useCtx","DropdownContext","MenuContext","OptionAction","s","Option","_a","onClick","to","active","red","valid","invalid","children","disabled","closeMenuOnClick","ctx","id","Date","getTime","toString","_c","searchTerm","addOption","setClickHandlerForOption","childrenArray","Children","toArray","buttons","filter","child","type","notButtons","contentRef","_d","innerText","setInnerText","current","closeMenu","handleClick","e","preventDefault","stopPropagation","navigateTo","toLowerCase","includes","content","createElement","Fragment","className","Dropdown__menu__option__content","ref","length","Dropdown__menu__option__icons","Dropdown__menu__option","_b"],"sources":["/Users/fabienpicard/Projects/astro-website/node_modules/datocms-react-ui/src/Dropdown/Option.tsx"],"sourcesContent":["import classNames from 'classnames';\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useCtx } from '..';\nimport { DropdownContext } from './DropdownContext';\nimport { MenuContext } from './MenuContext';\nimport { OptionAction } from './OptionAction';\nimport s from './styles.module.css.json';\n\nexport type OptionProps = {\n  onClick?: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  to?: string;\n  active?: boolean;\n  red?: boolean;\n  valid?: boolean;\n  invalid?: boolean;\n  children: React.ReactNode;\n  disabled?: boolean;\n  closeMenuOnClick?: boolean;\n};\n\nexport const Option = ({\n  onClick,\n  to,\n  active,\n  red,\n  valid,\n  invalid,\n  children,\n  disabled,\n  closeMenuOnClick,\n}: OptionProps): JSX.Element | null => {\n  const ctx = useCtx();\n\n  const id = useMemo(() => new Date().getTime().toString(36), []);\n\n  const { searchTerm, addOption, setClickHandlerForOption } =\n    useContext(MenuContext);\n\n  const childrenArray = React.Children.toArray(children);\n\n  const buttons = childrenArray.filter(\n    (child) =>\n      typeof child === 'object' &&\n      'type' in child &&\n      child.type === OptionAction,\n  );\n\n  const notButtons = childrenArray.filter(\n    (child) =>\n      typeof child !== 'object' ||\n      !('type' in child) ||\n      child.type !== OptionAction,\n  );\n\n  const contentRef = useRef<HTMLButtonElement>(null);\n  const [innerText, setInnerText] = useState<string>('');\n\n  useEffect(() => {\n    if (contentRef.current) {\n      setInnerText(contentRef.current.innerText);\n    }\n  });\n\n  const { closeMenu } = useContext(DropdownContext);\n\n  const handleClick = useCallback(\n    (e) => {\n      if (!onClick && !to) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (disabled) {\n        return;\n      }\n\n      if (closeMenuOnClick ?? true) {\n        closeMenu();\n      }\n\n      if (to) {\n        ctx?.navigateTo(to);\n      }\n\n      if (onClick) {\n        onClick(e);\n      }\n    },\n    [closeMenuOnClick, closeMenu, onClick, to],\n  );\n\n  useEffect(() => {\n    return addOption(id);\n  }, [id]);\n\n  useEffect(() => {\n    return setClickHandlerForOption(id, handleClick);\n  }, [id, handleClick, setClickHandlerForOption]);\n\n  if (\n    innerText &&\n    searchTerm &&\n    !innerText.toLowerCase().includes(searchTerm.toLowerCase())\n  ) {\n    return null;\n  }\n\n  const content = (\n    <>\n      <button\n        type=\"button\"\n        className={s.Dropdown__menu__option__content}\n        ref={contentRef}\n        onClick={handleClick}\n      >\n        {notButtons}\n      </button>\n      {buttons.length > 0 && (\n        <div className={s.Dropdown__menu__option__icons}>{buttons}</div>\n      )}\n    </>\n  );\n\n  return (\n    <div\n      className={classNames(s.Dropdown__menu__option, {\n        [s['Dropdown__menu__option--is-active']]: active,\n        [s['Dropdown__menu__option--is-disabled']]: disabled,\n        [s['Dropdown__menu__option--is-valid']]: valid,\n        [s['Dropdown__menu__option--is-invalid']]: invalid,\n        [s['Dropdown__menu__option--is-dangerous']]: red,\n      })}\n      data-option-id={id}\n    >\n      {content}\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}